(self.AMP=self.AMP||[]).push({n:"amp-audio",v:"1525461683159",f:(function(AMP){function h(a,c){function e(){}e.prototype=c.prototype;a.prototype=new e;a.prototype.constructor=a;for(var b in c)if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(c,b);d&&Object.defineProperty(a,b,d)}else a[b]=c[b]};var k=Object.prototype.toString;self.log=self.log||{user:null,dev:null,userForEmbed:null};var l=self.log;function m(){if(!l.user)throw Error("failed to call initLogConstructor");return l.user};function n(a){this.m=a;this.h=Object.create(null)}n.prototype.get=function(a){if(this.h[a])return this.h[a].access=Date.now(),this.h[a].payload};n.prototype.put=function(a,c){var e=this;this.h[a]={payload:c,access:Date.now()};var b=Object.keys(this.h);if(b.length>this.m){if(l.dev)a=l.dev;else throw Error("failed to call initLogConstructor");a.warn("lru-cache","Trimming template cache");b.sort(function(a,c){return e.h[c].access-e.h[a].access});delete this.h[b[b.length-1]]}};(function(a){return a||{}})({c:!0,v:!0,a:!0,ad:!0});var p,q,r=["javascript:","data:","vbscript:"];
function t(a){var c;p||(p=self.document.createElement("a"),q=self.UrlCache||(self.UrlCache=new n(100)));var e=q.get(a);if(e)return e;var b=p;b.href=a;b.protocol||(b.href=b.href);var d={href:b.href,protocol:b.protocol,host:b.host,hostname:b.hostname,port:"0"==b.port?"":b.port,pathname:b.pathname,search:b.search,hash:b.hash,origin:null};"/"!==d.pathname[0]&&(d.pathname="/"+d.pathname);if("http:"==d.protocol&&80==d.port||"https:"==d.protocol&&443==d.port)d.port="",d.host=d.hostname;d.origin=b.origin&&
"null"!=b.origin?b.origin:"data:"!=d.protocol&&d.host?d.protocol+"//"+d.host:d.href;var f=d,g=f;if(c)return g;q.put(a,g);return g}function w(a){"string"==typeof a&&(a=t(a));var c;(c="https:"==a.protocol||"localhost"==a.hostname)||(a=a.hostname,c=a.length-10,c=0<=c&&a.indexOf(".localhost",c)==c);return c}
function x(a,c){var e;e=void 0===e?"source":e;m().assert(null!=a,"%s %s must be available",c,e);var b=a;m().assert(w(b)||/^(\/\/)/.test(b),'%s %s must start with "https://" or "//" or be relative and served from either https or from localhost. Invalid value: %s',c,e,b)}function y(a){if(!a)return!0;"string"==typeof a&&(a=t(a));return!r.includes(a.protocol)};var z;function A(a,c){function e(a){try{return f(a)}catch(u){throw self.reportError(u),u;}}var b=void 0,d=a,f=c,g=B(),v=!1;b&&(v=b.capture);d.addEventListener("playing",e,g?b:v)}function B(){if(void 0!==z)return z;z=!1;try{var a={get capture(){z=!0}};self.addEventListener("test-options",null,a);self.removeEventListener("test-options",null,a)}catch(c){}return z};function C(a,c){A(a,c)};var D={title:"",artist:"",album:"",artwork:[{src:""}]};function E(a,c,e,b){var d=a.navigator;"mediaSession"in d&&a.MediaMetadata&&(d.mediaSession.metadata=new a.MediaMetadata(D),F(c),d.mediaSession.metadata=new a.MediaMetadata(c),d.mediaSession.setActionHandler("play",e),d.mediaSession.setActionHandler("pause",b))}
function G(a){var c=a.querySelector('script[type="application/ld+json"]');if(c){var e;a:{try{e=JSON.parse(c.textContent);break a}catch(d){}e=void 0}var b=e;if(b&&b.image){if("string"===typeof b.image)return b.image;if(b.image["@list"]&&"string"===typeof b.image["@list"][0])return b.image["@list"][0];if("string"===typeof b.image.url)return b.image.url;if("string"===typeof b.image[0])return b.image[0]}}}
function H(a){var c=a.querySelector('meta[property="og:image"]');if(c)return c.getAttribute("content")}function I(a){var c=a.querySelector('link[rel="shortcut icon"]')||a.querySelector('link[rel="icon"]');if(c)return c.getAttribute("href")}function F(a){a&&a.artwork&&(Array.isArray(a.artwork),a.artwork.forEach(function(a){if(a){var c="[object Object]"===k.call(a)?a.src:a;m().assert(y(c))}}))};function J(a){a=AMP.BaseElement.call(this,a)||this;a.j=null;a.l=D;return a}h(J,AMP.BaseElement);J.prototype.isLayoutSupported=function(a){return"fixed"==a||"fixed-height"==a};
J.prototype.layoutCallback=function(){var a=this,c=this.element.ownerDocument.createElement("audio");if(!c.play)return this.toggleFallback(!0),Promise.resolve();c.controls=!0;this.element.getAttribute("src")&&x(this.element.getAttribute("src"),this.element);this.propagateAttributes("src preload autoplay muted loop aria-label aria-describedby aria-labelledby controlsList".split(" "),c);this.applyFillContent(c);this.getRealChildNodes().forEach(function(a){a.getAttribute&&a.getAttribute("src")&&x(a.getAttribute("src"),
a);c.appendChild(a)});this.element.appendChild(c);this.j=c;var e=this.getAmpDoc().win.document,b=this.element.getAttribute("artist"),d=this.element.getAttribute("title")||this.element.getAttribute("aria-label")||e.title,f=this.element.getAttribute("album"),e=this.element.getAttribute("artwork")||G(e)||H(e)||I(e);this.l={title:d||"",artist:b||"",album:f||"",artwork:[{src:e||""}]};C(this.j,function(){return K(a)});return this.loadPromise(c)};J.prototype.pauseCallback=function(){this.j&&this.j.pause()};
function K(a){E(a.getAmpDoc().win,a.l,function(){a.j.play()},function(){a.j.pause()})}(function(a){a.registerElement("amp-audio",J)})(self.AMP);
})});
//# sourceMappingURL=amp-audio-0.1.js.map

